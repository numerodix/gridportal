<HTML><HEAD><TITLE>MiscUtils/CSVJoiner.py</TITLE></HEAD>
                  <BODY BGCOLOR=#EEEEEE>
                  <!--header-->
                  <!--script--><PRE><FONT COLOR=black><B>import</B></FONT> types


<FONT COLOR=black><B>def</B></FONT> joinCSVFields(fields):
    <FONT COLOR=#FF0000>"""
    Returns a CSV record (eg a string) from a sequence of fields.
    Fields containing commands (,) or double quotes (") are quotes
    and double quotes are escaped (""). The terminating newline is
    NOT included.
    """</FONT>
    newFields = []
    <FONT COLOR=black><B>for</B></FONT> field <FONT COLOR=black><B>in</B></FONT> fields:
        <FONT COLOR=black><B>assert</B></FONT> type(field) <FONT COLOR=black><B>is</B></FONT> types.StringType
        <FONT COLOR=black><B>if</B></FONT> field.find(<FONT COLOR=#FF0000>'"'</FONT>)!=-1:
            newField = <FONT COLOR=#FF0000>'"'</FONT> + field.replace(<FONT COLOR=#FF0000>'"'</FONT>, <FONT COLOR=#FF0000>'""'</FONT>) + <FONT COLOR=#FF0000>'"'</FONT>
        <FONT COLOR=black><B>elif</B></FONT> field.find(<FONT COLOR=#FF0000>','</FONT>)!=-1 <FONT COLOR=black><B>or</B></FONT> field.find(<FONT COLOR=#FF0000>'\n'</FONT>)!=-1 <FONT COLOR=black><B>or</B></FONT> field.find(<FONT COLOR=#FF0000>'\r'</FONT>)!=-1:
            newField = <FONT COLOR=#FF0000>'"'</FONT> + field + <FONT COLOR=#FF0000>'"'</FONT>
        <FONT COLOR=black><B>else</B></FONT>:
            newField = field
        newFields.append(newField)
    <FONT COLOR=black><B>return</B></FONT> <FONT COLOR=#FF0000>','</FONT>.join(newFields)
</PRE>
                  <!--footer-->
                  </BODY>
