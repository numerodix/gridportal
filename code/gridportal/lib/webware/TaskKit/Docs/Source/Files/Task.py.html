<HTML><HEAD><TITLE>TaskKit/Task.py</TITLE></HEAD>
                  <BODY BGCOLOR=#EEEEEE>
                  <!--header-->
                  <!--script--><PRE><FONT COLOR=black><B>from</B></FONT> MiscUtils <FONT COLOR=black><B>import</B></FONT> AbstractError


<FONT COLOR=black><B>class</B></FONT> Task:

    <FONT COLOR=black><B>def</B></FONT> __init__(self):
        <FONT COLOR=#FF0000>""" Subclasses should invoke super for this method. """</FONT>
        <FONT COLOR=#1111CC># Nothing for now, but we might do something in the future.</FONT>
        <FONT COLOR=black><B>pass</B></FONT>

    <FONT COLOR=black><B>def</B></FONT> run(self):
        <FONT COLOR=#FF0000>"""
        Override this method for you own tasks. Long running tasks can periodically 
        use the proceed() method to check if a task should stop. 
        """</FONT>
        <FONT COLOR=black><B>raise</B></FONT> AbstractError, self.__class__
    
        
    <FONT COLOR=#1111CC>## Utility method ##    </FONT>
    
    <FONT COLOR=black><B>def</B></FONT> proceed(self):
        <FONT COLOR=#FF0000>"""
        Should this task continue running?
        Should be called periodically by long tasks to check if the system wants them to exit.
        Returns 1 if its OK to continue, 0 if its time to quit
        """</FONT>
        <FONT COLOR=black><B>return</B></FONT> self._handle._isRunning
        
        
    <FONT COLOR=#1111CC>## Attributes ##</FONT>
    
    <FONT COLOR=black><B>def</B></FONT> handle(self):
        <FONT COLOR=#FF0000>"""
        A task is scheduled by wrapping a handler around it. It knows
        everything about the scheduling (periodicity and the like).
        Under normal circumstances you should not need the handler,
        but if you want to write period modifying run() methods, 
        it is useful to have access to the handler. Use it with care.
        """</FONT>
        <FONT COLOR=black><B>return</B></FONT> self._handle

    <FONT COLOR=black><B>def</B></FONT> name(self):
        <FONT COLOR=#FF0000>"""
        Returns the unique name under which the task was scheduled.
        """</FONT>
        <FONT COLOR=black><B>return</B></FONT> self._name


    <FONT COLOR=#1111CC>## Private method ##</FONT>

    <FONT COLOR=black><B>def</B></FONT> _run(self, handle):
        <FONT COLOR=#FF0000>"""
        This is the actual run method for the Task thread. It is a private method which
        should not be overriden.
        """</FONT>
        self._name = handle.name()
        self._handle = handle
        self.run()
        handle.notifyCompletion()
</PRE>
                  <!--footer-->
                  </BODY>
